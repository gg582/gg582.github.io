<!DOCTYPE html>

<link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/assets/css/syntax.css">

<html>

{% include head.html %}

<body>
  <script>
    (function() {
      var storageKey = 'theme';
      var className = 'dark-mode';
      var noTransitionClass = 'no-transition';
      
      var body = document.body;
      // Add no-transition class immediately
      body.classList.add(noTransitionClass);

      var theme = localStorage.getItem(storageKey);
      var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

      if (theme === 'dark' || (!theme && prefersDark)) {
        body.classList.add(className);
      }

      // Remove no-transition class after page load
      window.addEventListener('load', function() {
        requestAnimationFrame(function() {
          body.classList.remove(noTransitionClass);
        });
      });
    })();
  </script>

  {% include navbar.html %}

  <script>
    (function() {
      // Sync checkbox immediately after navbar inclusion to prevent animation
      var theme = localStorage.getItem('theme');
      var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (theme === 'dark' || (!theme && prefersDark)) {
        var checkbox = document.getElementById('checkbox');
        if (checkbox) checkbox.checked = true;
      }
    })();
  </script>

  {{ content }}

  {% include footer.html %}

  {% include featured-lightbox.html %}

  {% include scripts.html %}

  {% include google-analytics.html %}

</body>

</html>
